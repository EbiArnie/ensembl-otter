#! /bin/bash

# Wrapper script to choose "otter" for the distro,
# then run otterlace inside.
#
# Symlink it as any of otterlace_{live,dev,test}
# where you would otherwise symlink directly to ../otter/otter_$TRACK/bin/otterlace

track="$( basename $0 | cut -d_ -f2 )"
codename="$( lsb_release -sc )"
otter_home="/software/anacode/otter/otter_$track-$codename"

[ -d "$otter_home" ] || {
    printf "\nI don't have the %s needed by %s\n  for %s/%s on %s\n\n" \
        "$otter_home" "$0" "$codename" "$( uname -m )" "$(hostname -f)" >&2
    exit 1
}


echo "Distro-wrapper: running $otter_home/bin/otterlace"
ls -l "$otter_home"
exec "$otter_home/bin/otterlace"
