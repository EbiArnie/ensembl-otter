#!/usr/local/bin/perl -Tw

# Author:        jgrg
# Group:         anacode
# Maintainer:    jgrg

use strict;
use warnings;

use SangerPaths qw{ core bioperl123 ensembl61 otter54 };

use Bio::Otter::ServerScriptSupport;

my $server = Bio::Otter::ServerScriptSupport->new;

my $sth = $server->otter_dba()->dbc()->prepare(qq{
    SELECT meta_key, meta_value
      FROM meta
  ORDER BY meta_id
});
$sth->execute;

my $counter = 0;
my $output_string ='';

while (my ($meta_key, $meta_value) = $sth->fetchrow) {

    $meta_value=~s/\s+/ /g; # get rid of newlines and tabs

    $output_string .= join("\t", $meta_key, $meta_value)."\n";
    $counter++;
}

warn "Total of $counter meta table pairs sent\n";

$server->send_response($output_string, 1);

1;

