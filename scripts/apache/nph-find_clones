#!/usr/local/bin/perl -Tw

# Author:        jgrg
# Group:         anacode
# Maintainer:    jgrg
# Last modified: $Date: 2008-02-22 14:29:37 $
# Id:            $Id: nph-find_clones,v 1.7 2008-02-22 14:29:37 jgrg Exp $
# Source:        $Source: /tmp/ENSCOPY-ENSEMBL-OTTER/scripts/apache/Attic/nph-find_clones,v $

use strict;
use SangerPaths qw{ core bioperl123 ensembl46 otter48 };

use Bio::Otter::ServerScriptSupport;
use Bio::Otter::CloneFinder; # $server->running_headcode()==0 version
use Bio::Vega::CloneFinder;  # $server->running_headcode()==1 version

my $server = Bio::Otter::ServerScriptSupport->new;

my $qnames       = $server->require_argument('qnames');
my $filter_atype = $server->param('type')   || '';
my $unhide       = $server->param('unhide') || 0;

my $finder_class = $server->running_headcode()
    ? 'Bio::Vega::CloneFinder'
    : 'Bio::Otter::CloneFinder';

my $finder = $finder_class->new( $server->otter_dba(), [ split(',', $qnames) ]);

$finder->find($unhide);

my $output_string = $finder->generate_output($filter_atype);

$server->send_response($output_string, 1);

1;

